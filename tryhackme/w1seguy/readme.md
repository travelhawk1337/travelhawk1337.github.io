## w1seguy

### Tasks

1. **Source Code**

    Download the source code. Start the machine.

2. **Get those flags!**

    - **What is the first flag?**

        Reading the Python script reveals that the flag is XORed with a key of length 5 and then it is converted to hex. The character set used for the key is all the ASCII letters along with digits. It can be brute-forced easily; we can check whether the plaintext starts with "THM{" and ends with "}" or not. But that's not an elegant way to do that. Let's analyze it further.

        We know that the flag starts with "THM{" and ends with "}". The key is of length 5. On checking the length of the unhexed flag, we find it to be of length 40. The key can be easily generated again using the properties of XOR:

        ```
        plaintext ^ key = ciphertext
        ciphertext ^ key = plaintext
        ciphertext ^ plaintext = key
        ```

        The first 4 letters of the key can be generated by XORing the encrypted flag using "THM{". For the final letter, we can take the XOR of the last element of the flag and "}". Here is a simple Python script to achieve this:

        ```python
        def xor_break(encoded):
            u = bytes.fromhex(encoded)  # Converting hex to bytes
            key = "".join(chr(ord(x) ^ y) for x, y in zip("THM{", u[0:4]))  # First 4 chars of the key
            key += chr(ord("}") ^ u[-1])  # Final char of the key
            print("key is: ", key)
            flag = "".join(chr(u[i] ^ ord(key[i % 5])) for i in range(len(u)))  # Generating the flag
            print(flag)
        
        xor_break("3f1d3b43475a341a56432e2d0279431f611553542a3b040b5607190f506219210f0842192d394a4a")
        ```
        
        Answer: `THM{p1alntExtAtt4ckcAnr3alLyhUrty0urxOr}`

    - **What is the second and final flag?**

        Answer: `THM{THM{BrUt3_ForC1nG_XOR_cAn_B3_FuN_nO?}`

